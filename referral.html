<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Referral - VORTEXA ID</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk&display=swap" rel="stylesheet">
    <script type="module" src="https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <button class="back-button" id="backButton">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="header-title">Referral</div>
            <div class="header-logo">VORTEXA ID</div>
        </header>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Loading State -->
            <div class="loading-container" id="loading">
                <div class="spinner"></div>
                <p>Memuat data referral...</p>
            </div>

            <div class="referral-content" id="referralContent" style="display: none;">

    <section class="hero-section-referral">

        <div class="hero-icon-referral">
            <i class="fas fa-users"></i>
        </div>

        <h1 class="hero-title-referral">
            Undang Teman, Dapatkan Bonus Tunai
        </h1>

        <p class="hero-desc-referral">
            Bagikan link referral Anda dan dapatkan bonus langsung ke saldo.
            Tidak ada batas undangan, semakin banyak teman bergabung semakin besar penghasilan Anda.
        </p>

        <div class="benefits-grid-referral">

            <!-- Bonus Daftar -->
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="benefit-text">
                    <h3>Rp 2.000</h3>
                    <p>Setiap teman berhasil mendaftar</p>
                </div>
            </div>

            <!-- Bonus Deposit -->
            <div class="benefit-card highlight">
                <div class="benefit-icon">
                    <i class="fas fa-wallet"></i>
                </div>
                <div class="benefit-text">
                    <h3>Rp 10.000</h3>
                    <p>Deposit pertama disetujui</p>
                </div>
            </div>

        </div>

        <div class="referral-note-box">
            <i class="fas fa-info-circle"></i>
            Bonus otomatis masuk ke saldo utama tanpa proses manual.
        </div>

    </section>

</div>

                <!-- Referral Code Section -->
                <section class="referral-code-section">
                    <div class="card referral-code-card">
                        <div class="card-header">
                            <h2><i class="fas fa-user-plus"></i> Kode Referral Anda</h2>
                        </div>
                        <div class="card-body">
                            <div class="referral-code-display" id="referralCode">-</div>
                            <div class="referral-link-info">
                                <i class="fas fa-link"></i>
                                <span id="referralLink">https://vortexaid.com/daftar?ref=</span>
                            </div>
                            <div class="action-buttons">
                                <button class="btn-secondary" id="copyCodeBtn">
                                    <i class="fas fa-copy"></i> Salin Kode
                                </button>
                                <button class="btn-secondary" id="copyLinkBtn">
                                    <i class="fas fa-share-alt"></i> Salin Link
                                </button>
                                <button class="btn-primary" id="shareNowBtn">
                                    <i class="fas fa-share"></i> Bagikan Sekarang
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Statistics Section -->
                <section class="statistics-section">
                    <div class="card summary-card">
                        <div class="card-header">
                            <h2><i class="fas fa-chart-bar"></i> Statistik Referral Anda</h2>
                        </div>
                        <div class="card-body">
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <div class="summary-label">Total Referral</div>
                                    <div class="summary-value" id="totalReferrals">0</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">Total Bonus</div>
                                    <div class="summary-value" id="totalBonus">Rp 0</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">Bonus/Hari</div>
                                    <div class="summary-value" id="dailyAverage">Rp 0</div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-label">Status</div>
                                    <div class="summary-value" id="referralStatus">Aktif</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Referral List Section -->
                <section class="referral-list-section">
                    <div class="card referral-list-card">
                        <div class="card-header">
                            <h2><i class="fas fa-users"></i> Daftar Referral</h2>
                            <div class="badge" id="referralCount">0</div>
                        </div>
                        <div class="card-body">
                            <div class="referral-list" id="referralList">
                                <!-- Referral items will be dynamically inserted here -->
                            </div>
                            
                            <!-- Empty State -->
                            <div class="empty-state" id="emptyState">
                                <i class="fas fa-users-slash"></i>
                                <h3>Belum ada referral</h3>
                                <p>Bagikan kode referral Anda untuk mengundang teman dan dapatkan bonus!</p>
                                
                           </div>
                        </div>
                    </div>
                </section>

                <!-- Tips & Tricks Section -->
                <section class="tips-section">
                    <div class="card tips-card">
                        <div class="card-header">
                            <h2><i class="fas fa-lightbulb"></i> Tips & Trik Sukses Referral</h2>
                        </div>
                        <div class="card-body">
                            <div class="tips-grid">
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-comment-alt"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h3>Jelaskan Manfaat</h3>
                                        <p>Ceritakan pengalaman Anda berinvestasi di VORTEXA ID dan manfaat yang sudah didapatkan.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-user-check"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h3>Target Tepat</h3>
                                        <p>Ajak teman yang memang tertarik dengan investasi dan ingin mendapatkan keuntungan.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-shield-alt"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h3>Hindari Spam</h3>
                                        <p>Jangan spam pesan referral. Fokus pada kualitas daripada kuantitas.</p>
                                    </div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-icon">
                                        <i class="fas fa-handshake"></i>
                                    </div>
                                    <div class="tip-content">
                                        <h3>Bantu Proses</h3>
                                        <p>Bantu teman Anda memahami cara mendaftar, dan melakukan deposit pertama.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="rules-note">
                                <h4><i class="fas fa-exclamation-triangle"></i> Penting!</h4>
                                <ul>
                                    <li>Maksimal 20 referral per hari</li>
                                    <li>Maksimal bonus Rp 500.000 per hari</li>
                                    <li>Dilarang membuat akun sendiri untuk referral</li>
                                    <li>Bonus hanya untuk referral yang valid dan aktif</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="footer-logo">VORTEXA ID</div>
                <div class="footer-links">
                    <a href="about.html">Tentang</a>
                    <a href="terms.html">Syarat</a>
                    <a href="privacy.html">Privasi</a>
                </div>
                <div class="footer-copy">© 2026 VORTEXA ID. All rights reserved.</div>
            </div>
        </footer>

        <!-- Toast Notification -->
        <div class="toast" id="toast"></div>

        <!-- Share Guide Modal -->
        <div class="modal-overlay" id="shareModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-share-alt"></i> Cara Berbagi Referral</h2>
                    <button class="modal-close" id="closeModalBtn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="share-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Salin Link Referral</h3>
                            <p>Gunakan tombol "Salin Link" di halaman referral untuk menyalin tautan unik Anda.</p>
                        </div>
                    </div>
                    <div class="share-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Bagikan ke Media Sosial</h3>
                            <p>Bagikan link referral Anda melalui WhatsApp, Telegram, atau media sosial lainnya.</p>
                        </div>
                    </div>
                    <div class="share-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Pantau Perkembangan</h3>
                            <p>Pantau status referral dan bonus yang Anda dapatkan di halaman ini.</p>
                        </div>
                    </div>
                    <div class="share-tips">
                        <h4><i class="fas fa-lightbulb"></i> Tips Sukses:</h4>
                        <ul>
                            <li>Jelaskan manfaat platform dengan jelas</li>
                            <li>Bagikan pengalaman investasi Anda</li>
                            <li>Jangan spam, fokus pada teman yang tertarik investasi</li>
                            <li>Bantu teman memahami cara deposit pertama</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary" id="copyAllLinkBtn">
                        <i class="fas fa-copy"></i> Salin Link Saya Sekarang
                    </button>
                </div>
            </div>
        </div>

        <!-- Share Options Modal -->
        <div class="modal-overlay" id="shareOptionsModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-share-square"></i> Bagikan Referral</h2>
                    <button class="modal-close" id="closeShareOptionsBtn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="share-options">
                        <button class="share-option-btn" id="shareWhatsAppBtn">
                            <i class="fab fa-whatsapp"></i>
                            <span>WhatsApp</span>
                        </button>
                        <button class="share-option-btn" id="shareTelegramBtn">
                            <i class="fab fa-telegram"></i>
                            <span>Telegram</span>
                        </button>
                        <button class="share-option-btn" id="shareFacebookBtn">
                            <i class="fab fa-facebook"></i>
                            <span>Facebook</span>
                        </button>
                        <button class="share-option-btn" id="shareTwitterBtn">
                            <i class="fab fa-twitter"></i>
                            <span>Twitter</span>
                        </button>
                        <button class="share-option-btn" id="shareEmailBtn">
                            <i class="fas fa-envelope"></i>
                            <span>Email</span>
                        </button>
                        <button class="share-option-btn" id="shareSMSBtn">
                            <i class="fas fa-sms"></i>
                            <span>SMS</span>
                        </button>
                    </div>
                    <div class="custom-message">
                        <h4><i class="fas fa-edit"></i> Pesan Kustom</h4>
                        <textarea id="customMessage" placeholder="Tulis pesan Anda di sini...">Halo! Saya ingin mengundang Anda bergabung dengan VORTEXA ID, platform investasi terpercaya. Dapatkan bonus Rp 10.000 gratis saat mendaftar menggunakan link ini: </textarea>
                        <button class="btn-secondary" id="copyCustomMessageBtn">
                            <i class="fas fa-copy"></i> Salin Pesan
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary" id="copyShareLinkBtn">
                        <i class="fas fa-link"></i> Salin Link Referral
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(26, 35, 126, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 229, 255, 0.05) 0%, transparent 50%);
            z-index: -1;
        }

        /* Particle Background */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: #ffffff;
            border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* App Container */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .app-header {
            background: rgba(10, 25, 49, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 229, 255, 0.2);
            padding: 16px;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-button {
            background: transparent;
            border: none;
            color: #00e5ff;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: rgba(0, 229, 255, 0.1);
            transform: translateX(-2px);
        }

        .header-title {
            flex: 1;
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #ffffff;
        }

        .header-logo {
            font-family: 'Space Grotesk', monospace;
            font-size: 1rem;
            color: #00e5ff;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 16px;
            padding-bottom: 80px;
        }

        section {
            margin-bottom: 24px;
        }
        
        /* ===============================
   REFERRAL HERO SECTION
================================ */

.hero-section-referral {
    background: linear-gradient(180deg, rgba(255,215,0,0.08), rgba(0,0,0,0));
    border-radius: 18px;
    padding: 26px 20px 30px;
    text-align: center;
    margin-bottom: 24px;
}

.hero-icon-referral {
    width: 64px;
    height: 64px;
    margin: 0 auto 12px;
    border-radius: 50%;
    background: radial-gradient(circle at top, #ffd700, #b8860b);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 18px rgba(255,215,0,0.45);
}

.hero-icon-referral i {
    color: #000;
    font-size: 26px;
}

.hero-title-referral {
    font-size: 20px;
    font-weight: 700;
    color: #ffd700;
    margin-bottom: 10px;
}

.hero-desc-referral {
    font-size: 13.5px;
    line-height: 1.6;
    color: #d0d0d0;
    margin-bottom: 22px;
}

/* ===============================
   BENEFITS GRID
================================ */

.benefits-grid-referral {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-bottom: 20px;
}

.benefit-card {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    padding: 16px 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: transform .25s ease, box-shadow .25s ease;
}

.benefit-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
}

.benefit-card.highlight {
    border-color: rgba(255,215,0,0.6);
    background: linear-gradient(
        135deg,
        rgba(255,215,0,0.15),
        rgba(255,215,0,0.04)
    );
}

.benefit-icon {
    width: 42px;
    height: 42px;
    border-radius: 10px;
    background: rgba(255,215,0,0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ffd700;
    font-size: 18px;
}

.benefit-text h3 {
    font-size: 15px;
    font-weight: 700;
    color: #ffd700;
    margin: 0 0 4px;
}

.benefit-text p {
    font-size: 12.5px;
    color: #cfcfcf;
    margin: 0;
}

/* ===============================
   NOTE BOX
================================ */

.referral-note-box {
    display: flex;
    align-items: center;
    gap: 8px;
    justify-content: center;
    font-size: 12.5px;
    color: #bdbdbd;
    padding-top: 10px;
}

.referral-note-box i {
    color: #ffd700;
}

/* ===============================
   MOBILE TWEAK
================================ */

@media (max-width: 480px) {
    .hero-title-referral {
        font-size: 18px;
    }

    .benefits-grid-referral {
        grid-template-columns: 1fr;
    }
}

        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            gap: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 229, 255, 0.3);
            border-top-color: #00e5ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-container p {
            color: #b0b0b0;
            font-size: 0.875rem;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 24px 16px;
            background: linear-gradient(135deg, rgba(0, 229, 255, 0.1), rgba(26, 35, 126, 0.2));
            border-radius: 16px;
            border: 1px solid rgba(0, 229, 255, 0.2);
            margin-bottom: 24px;
        }

        .hero-icon {
            font-size: 3rem;
            color: #00e5ff;
            margin-bottom: 16px;
        }

        .hero-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: #ffffff;
        }

        .hero-description {
            color: #b0b0b0;
            font-size: 0.9375rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto 24px;
        }

        .highlight {
            color: #00e5ff;
            font-weight: 600;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            max-width: 400px;
            margin: 0 auto;
        }

        .benefit-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px 12px;
            text-align: center;
            border: 1px solid rgba(0, 229, 255, 0.1);
            transition: all 0.3s ease;
        }

        .benefit-item:hover {
            transform: translateY(-2px);
            background: rgba(0, 229, 255, 0.1);
        }

        .benefit-icon {
            font-size: 1.5rem;
            color: #00e5ff;
            margin-bottom: 8px;
        }

        .benefit-content h3 {
            font-size: 1.125rem;
            font-weight: 700;
            color: #4caf50;
            margin-bottom: 4px;
            font-family: 'Space Grotesk', monospace;
        }

        .benefit-content p {
            font-size: 0.75rem;
            color: #b0b0b0;
        }

        /* Cards */
        .card {
            background: rgba(10, 25, 49, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 229, 255, 0.2);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 229, 255, 0.15);
        }

        .card-header {
            padding: 20px 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h2 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-header h2 i {
            color: #00e5ff;
        }

        .badge {
            background: linear-gradient(135deg, #00e5ff, #2979ff);
            color: #000000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .card-body {
            padding: 20px;
        }

        /* Referral Code Section */
        .referral-code-display {
            font-family: 'Space Grotesk', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: #00e5ff;
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            margin-bottom: 15px;
            letter-spacing: 2px;
            border: 2px solid rgba(0, 229, 255, 0.3);
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        .referral-link-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.875rem;
            color: #b0b0b0;
            word-break: break-all;
        }

        .referral-link-info i {
            color: #00e5ff;
            flex-shrink: 0;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 768px) {
            .action-buttons {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Buttons */
        .btn-primary, .btn-secondary {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00e5ff, #2979ff);
            color: #000000;
        }

        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(0, 229, 255, 0.9);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: transparent;
            color: #00e5ff;
            border: 2px solid #00e5ff;
        }

        .btn-secondary:hover {
            background: rgba(0, 229, 255, 0.1);
        }

        /* Statistics Section */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        @media (min-width: 768px) {
            .summary-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .summary-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .summary-label {
            font-size: 0.75rem;
            color: #b0b0b0;
            margin-bottom: 8px;
        }

        .summary-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: #ffffff;
        }

        #totalBonus, #dailyAverage {
            color: #4caf50;
            font-family: 'Space Grotesk', monospace;
        }

        /* Referral List Section */
        .referral-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .referral-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #00e5ff;
        }

        .referral-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .referral-username {
            font-weight: 600;
            color: #ffffff;
            font-size: 0.9375rem;
        }

        .referral-date {
            font-size: 0.75rem;
            color: #b0b0b0;
        }

        .referral-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.6875rem;
            font-weight: 600;
            margin-right: 8px;
        }

        .status-registered {
            background: rgba(33, 150, 243, 0.2);
            color: #2196f3;
        }

        .status-verified {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }

        .status-purchased {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .referral-bonus {
            font-family: 'Space Grotesk', monospace;
            font-weight: 600;
            color: #4caf50;
            font-size: 0.875rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }

        .empty-state i {
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .empty-state p {
            color: #b0b0b0;
            font-size: 0.875rem;
            margin-bottom: 20px;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Tips & Tricks Section */
        .tips-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }

        @media (min-width: 768px) {
            .tips-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .tip-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            gap: 12px;
            align-items: flex-start;
            border: 1px solid rgba(0, 229, 255, 0.1);
        }

        .tip-icon {
            width: 40px;
            height: 40px;
            background: rgba(0, 229, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .tip-icon i {
            color: #00e5ff;
            font-size: 1.125rem;
        }

        .tip-content h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 4px;
            color: #ffffff;
        }

        .tip-content p {
            font-size: 0.8125rem;
            color: #b0b0b0;
            line-height: 1.5;
        }

        .rules-note {
            background: rgba(255, 152, 0, 0.1);
            border-radius: 8px;
            padding: 16px;
            border-left: 4px solid #ff9800;
        }

        .rules-note h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ff9800;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .rules-note ul {
            list-style: none;
            padding-left: 0;
        }

        .rules-note li {
            font-size: 0.8125rem;
            color: #b0b0b0;
            padding: 4px 0;
            padding-left: 20px;
            position: relative;
        }

        .rules-note li::before {
            content: '•';
            position: absolute;
            left: 0;
            color: #ff9800;
        }

        /* Footer */
        .app-footer {
            background: rgba(10, 25, 49, 0.9);
            border-top: 1px solid rgba(0, 229, 255, 0.2);
            padding: 20px 16px;
            margin-top: auto;
        }

        .footer-content {
            text-align: center;
        }

        .footer-logo {
            font-family: 'Space Grotesk', monospace;
            font-size: 1rem;
            color: #00e5ff;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }

        .footer-links a {
            color: #b0b0b0;
            text-decoration: none;
            font-size: 0.75rem;
            transition: color 0.2s ease;
        }

        .footer-links a:hover {
            color: #00e5ff;
        }

        .footer-copy {
            color: #757575;
            font-size: 0.6875rem;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            color: #ffffff;
            padding: 12px 24px;
            border-radius: 8px;
            border: 1px solid rgba(0, 229, 255, 0.3);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 90%;
            text-align: center;
            font-size: 0.875rem;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: rgba(10, 25, 49, 0.95);
            border: 1px solid rgba(0, 229, 255, 0.3);
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: scaleUp 0.3s ease;
        }

        @keyframes scaleUp {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-header {
            padding: 24px 24px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: #b0b0b0;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 4px 12px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .modal-body {
            padding: 24px;
        }

        .share-step {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .step-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #00e5ff, #2979ff);
            color: #000000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
            flex-shrink: 0;
        }

        .step-content h3 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: #ffffff;
        }

        .step-content p {
            font-size: 0.875rem;
            color: #b0b0b0;
            line-height: 1.5;
        }

        .share-tips {
            background: rgba(0, 229, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .share-tips h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .share-tips ul {
            list-style: none;
            padding-left: 0;
        }

        .share-tips li {
            font-size: 0.875rem;
            color: #b0b0b0;
            padding: 5px 0;
            padding-left: 24px;
            position: relative;
        }

        .share-tips li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #00e5ff;
        }

        /* Share Options Modal */
        .share-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .share-option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 16px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #ffffff;
        }

        .share-option-btn:hover {
            background: rgba(0, 229, 255, 0.1);
            border-color: #00e5ff;
            transform: translateY(-2px);
        }

        .share-option-btn i {
            font-size: 1.5rem;
        }

        .share-option-btn span {
            font-size: 0.75rem;
            font-weight: 500;
        }

        .fab.fa-whatsapp { color: #25D366; }
        .fab.fa-telegram { color: #0088cc; }
        .fab.fa-facebook { color: #1877F2; }
        .fab.fa-twitter { color: #1DA1F2; }
        .fas.fa-envelope { color: #EA4335; }
        .fas.fa-sms { color: #34B7F1; }

        .custom-message {
            margin-top: 20px;
        }

        .custom-message h4 {
            font-size: 0.9375rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #customMessage {
            width: 100%;
            height: 100px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            color: #ffffff;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            resize: vertical;
            margin-bottom: 12px;
        }

        #customMessage::placeholder {
            color: #757575;
        }

        .modal-footer {
            padding: 0 24px 24px;
            text-align: center;
        }

        /* Responsive Design */
        @media (min-width: 768px) {
            .main-content {
                padding: 24px;
                padding-bottom: 100px;
            }

            .app-header {
                padding: 16px 24px;
            }

            .header-title {
                font-size: 1.375rem;
            }

            .header-logo {
                font-size: 1.125rem;
            }

            .hero-title {
                font-size: 1.75rem;
            }

            .hero-description {
                font-size: 1rem;
            }

            .benefit-item {
                padding: 20px 16px;
            }

            .benefit-content h3 {
                font-size: 1.25rem;
            }

            .referral-code-display {
                font-size: 2.5rem;
            }

            .card-header h2 {
                font-size: 1.25rem;
            }

            .app-footer {
                padding: 24px;
            }
        }

        @media (min-width: 1024px) {
            .main-content {
                padding: 32px;
                padding-bottom: 120px;
            }

            .app-header {
                padding: 20px 32px;
            }

            .referral-code-card .card-body {
                padding: 30px;
            }

            .referral-list {
                max-height: 500px;
            }

            .referral-item {
                padding: 20px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 229, 255, 0.3);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 229, 255, 0.5);
        }
    </style>

    <script type="module">
        // Import Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { 
            getAuth, 
            onAuthStateChanged,
            signOut
        } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
        
        import { 
            getFirestore, 
            collection, 
            doc, 
            getDoc, 
            getDocs, 
            query, 
            where, 
            orderBy,
            onSnapshot
        } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAEM8RddVyDgzeveu4ZV_5mnXpOf52EoP4",
            authDomain: "vortexaind.firebaseapp.com",
            projectId: "vortexaind",
            storageBucket: "vortexaind.firebasestorage.app",
            messagingSenderId: "94487454118",
            appId: "1:94487454118:web:2469612cf7082fb8ce2f67"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // DOM Elements
        const backButton = document.getElementById('backButton');
        const loading = document.getElementById('loading');
        const referralContent = document.getElementById('referralContent');
        const referralCode = document.getElementById('referralCode');
        const referralLink = document.getElementById('referralLink');
        const copyCodeBtn = document.getElementById('copyCodeBtn');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        const shareNowBtn = document.getElementById('shareNowBtn');
        const totalReferrals = document.getElementById('totalReferrals');
        const totalBonus = document.getElementById('totalBonus');
        const dailyAverage = document.getElementById('dailyAverage');
        const referralStatus = document.getElementById('referralStatus');
        const referralList = document.getElementById('referralList');
        const emptyState = document.getElementById('emptyState');
        const referralCount = document.getElementById('referralCount');
        const shareModal = document.getElementById('shareModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const copyAllLinkBtn = document.getElementById('copyAllLinkBtn');
        const shareOptionsModal = document.getElementById('shareOptionsModal');
        const closeShareOptionsBtn = document.getElementById('closeShareOptionsBtn');
        const copyShareLinkBtn = document.getElementById('copyShareLinkBtn');
        const copyCustomMessageBtn = document.getElementById('copyCustomMessageBtn');
        const customMessage = document.getElementById('customMessage');
        const shareWhatsAppBtn = document.getElementById('shareWhatsAppBtn');
        const shareTelegramBtn = document.getElementById('shareTelegramBtn');
        const shareFacebookBtn = document.getElementById('shareFacebookBtn');
        const shareTwitterBtn = document.getElementById('shareTwitterBtn');
        const shareEmailBtn = document.getElementById('shareEmailBtn');
        const shareSMSBtn = document.getElementById('shareSMSBtn');
        const toast = document.getElementById('toast');

        // Current User Data
        let currentUser = null;
        let userData = null;
        let referralLinkUrl = '';
        let unsubscribeReferrals = null;

        // Format Rupiah
        function formatRupiah(amount) {
            if (!amount) amount = 0;
            return 'Rp ' + amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        // Format Date
        function formatDate(timestamp) {
            if (!timestamp) return '-';
            const date = timestamp.toDate();
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }

        // Show Toast Notification
        function showToast(message, type = 'info') {
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Create Particle Background
        function createParticles() {
            const container = document.createElement('div');
            container.className = 'particles';
            document.body.appendChild(container);

            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.opacity = Math.random() * 0.7 + 0.3;
                star.style.animationDelay = `${Math.random() * 3}s`;
                star.style.animationDuration = `${Math.random() * 2 + 2}s`;
                
                container.appendChild(star);
            }
        }

        // Check System Maintenance
        async function checkMaintenance() {
            try {
                const configRef = doc(db, 'config', 'system');
                const configSnap = await getDoc(configRef);
                
                if (configSnap.exists() && configSnap.data().maintenance) {
                    window.location.href = 'maintenance.html';
                    return true;
                }
                return false;
            } catch (error) {
                console.error('Maintenance check error:', error);
                return false;
            }
        }

        // Load User Data
        async function loadUserData(uid) {
            try {
                const userRef = doc(db, 'users', uid);
                const userSnap = await getDoc(userRef);
                
                if (!userSnap.exists()) {
                    throw new Error('User data not found');
                }

                userData = userSnap.data();
                
                // Check account status
                if (userData.account_status !== 'active') {
                    window.location.href = 'banned.html';
                    return;
                }

                // Update UI with user data
                referralCode.textContent = userData.referral_code || 'BELUM-ADA';
                totalReferrals.textContent = userData.referral_count || 0;
                
                const bonusAmount = userData.referral_income || 0;
                totalBonus.textContent = formatRupiah(bonusAmount);
                
                // Calculate daily average (last 30 days)
                const daysSinceJoin = Math.max(1, Math.floor((Date.now() - userData.created_at?.toDate().getTime()) / (1000 * 60 * 60 * 24)));
                const dailyAvg = bonusAmount / Math.min(daysSinceJoin, 30);
                dailyAverage.textContent = formatRupiah(Math.round(dailyAvg));
                
                // Set referral link (DINAMIS IKUT DOMAIN)
const baseUrl = window.location.origin;
referralLinkUrl = `${baseUrl}/daftar.html?ref=${userData.referral_code}`;
referralLink.textContent = referralLinkUrl;
                
                // Update referral count badge
                referralCount.textContent = userData.referral_count || 0;

                // Update custom message with referral link
                customMessage.value = `Halo! Saya ingin mengundang Anda bergabung dengan VORTEXA ID, platform investasi terpercaya. Dapatkan bonus Rp 10.000 gratis saat mendaftar menggunakan link ini: ${referralLinkUrl}`;

            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Gagal memuat data pengguna', 'error');
            }
        }

        
        async function loadReferralList(uid) {
    try {
        const q = query(
            collection(db, 'users'),
            where('referred_by', '==', uid)
        );

        const snapshot = await getDocs(q);

        referralList.innerHTML = '';
        referralCount.textContent = snapshot.size;

        if (snapshot.empty) {
            emptyState.style.display = 'block';
            totalBonus.textContent = formatRupiah(0);
            return;
        }

        emptyState.style.display = 'none';

        let totalBonusCalc = 0;

        snapshot.forEach(docSnap => {
            const data = docSnap.data();

            let statusText = 'Terdaftar';
let badgeClass = 'status-registered';
let bonus = 2000;

if (data.has_deposit) {
    statusText = 'Sudah Deposit';
    badgeClass = 'status-purchased';
    bonus = 12000; // 2.000 + 10.000
}

            totalBonusCalc += bonus;

            const item = document.createElement('div');
            item.className = 'referral-item';
            item.innerHTML = `
                <div class="referral-header">
                    <div class="referral-username">
                        <i class="fas fa-user"></i> ${data.username}
                    </div>
                    <div class="referral-date">
                        ${formatDate(data.created_at)}
                    </div>
                </div>
                <div class="referral-details">
                    <span class="referral-status ${badgeClass}">
                        ${statusText}
                    </span>
                    <span class="referral-bonus">
                        ${formatRupiah(bonus)}
                    </span>
                </div>
            `;

            referralList.appendChild(item);
        });

        totalBonus.textContent = formatRupiah(totalBonusCalc);

    } catch (error) {
        console.error('Error loading referral list:', error);
        showToast('Gagal memuat daftar referral', 'error');
    }
}

        // Initialize Page
        function initPage() {
            createParticles();
            
            // Check authentication
            onAuthStateChanged(auth, async (user) => {
                if (!user) {
                    window.location.href = 'login.html';
                    return;
                }

                currentUser = user;

                // Check maintenance
                const isMaintenance = await checkMaintenance();
                if (isMaintenance) return;

                // Load user data
                await loadUserData(user.uid);
                
                // Load referral list
                await loadReferralList(user.uid);
                
                // Show content
                loading.style.display = 'none';
                referralContent.style.display = 'block';
            });
        }

        // Event Listeners
        backButton.addEventListener('click', () => {
            window.location.href = 'dashboard.html';
        });

        copyCodeBtn.addEventListener('click', async () => {
            const code = referralCode.textContent;
            if (code && code !== '-' && code !== 'BELUM-ADA') {
                try {
                    await navigator.clipboard.writeText(code);
                    showToast('Kode referral disalin!');
                } catch (error) {
                    console.error('Copy failed:', error);
                    showToast('Gagal menyalin kode', 'error');
                }
            }
        });

        copyLinkBtn.addEventListener('click', async () => {
            if (referralLinkUrl) {
                try {
                    await navigator.clipboard.writeText(referralLinkUrl);
                    showToast('Link referral disalin!');
                } catch (error) {
                    console.error('Copy failed:', error);
                    showToast('Gagal menyalin link', 'error');
                }
            }
        });

        shareNowBtn.addEventListener('click', () => {
            shareOptionsModal.style.display = 'flex';
        });

        closeModalBtn.addEventListener('click', () => {
            shareModal.style.display = 'none';
        });

        copyAllLinkBtn.addEventListener('click', async () => {
            if (referralLinkUrl) {
                try {
                    await navigator.clipboard.writeText(referralLinkUrl);
                    showToast('Link referral disalin!');
                    shareModal.style.display = 'none';
                } catch (error) {
                    console.error('Copy failed:', error);
                    showToast('Gagal menyalin link', 'error');
                }
            }
        });

        closeShareOptionsBtn.addEventListener('click', () => {
            shareOptionsModal.style.display = 'none';
        });

        copyShareLinkBtn.addEventListener('click', async () => {
            if (referralLinkUrl) {
                try {
                    await navigator.clipboard.writeText(referralLinkUrl);
                    showToast('Link referral disalin!');
                } catch (error) {
                    console.error('Copy failed:', error);
                    showToast('Gagal menyalin link', 'error');
                }
            }
        });

        copyCustomMessageBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(customMessage.value);
                showToast('Pesan kustom disalin!');
            } catch (error) {
                console.error('Copy failed:', error);
                showToast('Gagal menyalin pesan', 'error');
            }
        });

        // Social Share Functions
        function shareToWhatsApp() {
            const message = encodeURIComponent(customMessage.value);
            window.open(`https://wa.me/?text=${message}`, '_blank');
        }

        function shareToTelegram() {
            const message = encodeURIComponent(customMessage.value);
            window.open(`https://t.me/share/url?url=${referralLinkUrl}&text=${message}`, '_blank');
        }

        function shareToFacebook() {
            const url = encodeURIComponent(referralLinkUrl);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        }

        function shareToTwitter() {
            const message = encodeURIComponent(customMessage.value);
            window.open(`https://twitter.com/intent/tweet?text=${message}`, '_blank');
        }

        function shareToEmail() {
            const subject = encodeURIComponent('Undangan Bergabung VORTEXA ID');
            const body = encodeURIComponent(customMessage.value);
            window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
        }

        function shareToSMS() {
            const message = encodeURIComponent(customMessage.value);
            window.open(`sms:?body=${message}`, '_blank');
        }

        // Social share event listeners
        shareWhatsAppBtn.addEventListener('click', shareToWhatsApp);
        shareTelegramBtn.addEventListener('click', shareToTelegram);
        shareFacebookBtn.addEventListener('click', shareToFacebook);
        shareTwitterBtn.addEventListener('click', shareToTwitter);
        shareEmailBtn.addEventListener('click', shareToEmail);
        shareSMSBtn.addEventListener('click', shareToSMS);

        // Close modal when clicking outside
        shareModal.addEventListener('click', (e) => {
            if (e.target === shareModal) {
                shareModal.style.display = 'none';
            }
        });

        shareOptionsModal.addEventListener('click', (e) => {
            if (e.target === shareOptionsModal) {
                shareOptionsModal.style.display = 'none';
            }
        });

        // Initialize the page
        document.addEventListener('DOMContentLoaded', initPage);

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (unsubscribeReferrals) {
                unsubscribeReferrals();
            }
        });
    </script>
</body>
</html>